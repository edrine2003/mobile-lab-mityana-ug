<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ðŸ§ª Admin Dashboard</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  font-family: Arial;
  background:#f1f5f9;
  padding:20px;
}
.card{
  background:#fff;
  max-width:500px;
  margin:auto;
  padding:20px;
  border-radius:14px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
}
input,textarea,button{
  width:100%;
  padding:12px;
  margin-top:10px;
}
button{
  background:#0ea5e9;
  color:#fff;
  font-weight:bold;
  border:none;
  border-radius:10px;
}
</style>
</head>

<body>

<div class="card">
  <h2>ðŸ§ª Admin Dashboard</h2>
  <p>Upload lab results</p>

  <input id="email" placeholder="Patient Email">
  <input id="test" placeholder="Test Name (e.g HIV)">
  <textarea id="result" placeholder="Result details"></textarea>

  <button onclick="uploadResult()">Upload Result</button>

  <p id="msg"></p>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyA4II_I1weZZGzP990t9UWJCXjuK932pdY",
  authDomain: "mobile-lab-mityana-aeae2.firebaseapp.com",
  projectId: "mobile-lab-mityana-aeae2"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

// ðŸ” Protect admin page
auth.onAuthStateChanged(user=>{
  if(!user || user.email !== "edrinehero@gmail.com"){
    alert("Access denied");
    window.location.href="login.html";
  }
});

function uploadResult(){
  db.collection("results").add({
    patientEmail: email.value.trim(),
    testName: test.value.trim(),
    resultText: result.value.trim(),
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  }).then(()=>{
    msg.innerText="âœ… Result uploaded";
    email.value=test.value=result.value="";
  }).catch(err=>{
    msg.innerText=err.message;
  });
}
</script>

</body>
</html>
